<!DOCTYPE html>
<html>
<head>
    <title>Expense Tracker</title>
</head>
<body>

    <h2>Expense Tracker</h2>

    Title: <input type="text" id="title"><br><br>
    Amount: <input type="number" id="amount"><br><br>
    Date: <input type="date" id="date"><br><br>

    <button onclick="addExpense()">Add Expense</button>
    <button onclick="viewExpenses()">View Expenses</button>

    <ul id="expenseList"></ul>

    <script>
        let db;

        let request = indexedDB.open("ExpenseDB", 1);

        request.onupgradeneeded = function(event) {
            db = event.target.result;
            db.createObjectStore("expenses", { keyPath: "id", autoIncrement: true });
        };

        request.onsuccess = function(event) {
            db = event.target.result;
        };

        request.onerror = function() {
            alert("Database error");
        };

        function addExpense() {
            let transaction = db.transaction(["expenses"], "readwrite");
            let store = transaction.objectStore("expenses");

            let expense = {
                title: document.getElementById("title").value,
                amount: document.getElementById("amount").value,
                date: document.getElementById("date").value
            };

            let addRequest = store.add(expense);

            addRequest.onsuccess = function() {
                alert("Expense Added");
            };

            addRequest.onerror = function() {
                alert("Error Adding Expense");
            };
        }

        function viewExpenses() {
            let transaction = db.transaction(["expenses"], "readonly");
            let store = transaction.objectStore("expenses");
            let request = store.openCursor();

            let list = document.getElementById("expenseList");
            list.innerHTML = "";

            request.onsuccess = function(event) {
                let cursor = event.target.result;
                if (cursor) {
                    let li = document.createElement("li");
                    li.innerHTML = 
                        "ID: " + cursor.value.id +
                        " | " + cursor.value.title +
                        " | â‚¹" + cursor.value.amount +
                        " | " + cursor.value.date +
                        " <button onclick='deleteExpense(" + cursor.value.id + ")'>Delete</button>";
                    list.appendChild(li);
                    cursor.continue();
                }
            };
        }

        function deleteExpense(id) {
            let transaction = db.transaction(["expenses"], "readwrite");
            let store = transaction.objectStore("expenses");
            store.delete(id);
            alert("Expense Deleted");
            viewExpenses();
        }
    </script>

</body>
</html>